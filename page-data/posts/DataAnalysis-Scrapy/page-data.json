{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/DataAnalysis-Scrapy","webpackCompilationHash":"f24a41c5c3d6badf0a90","result":{"data":{"markdownRemark":{"id":"047b86c9-80b2-5e73-bb74-1dacb01935c4","html":"<p>With a colleague at WeCode, which is a coding bootcamp based in Seoul, South Korea, I am doing a data analysis project on the relationship betwen box office and music daily chart. We are trying to see how box office affects what people listen to in their daily lives. Not sure how much correlation there would be, but this would be beneficial.</p>\n<h1 id=\"1-what-is-scrapy\"><a href=\"#1-what-is-scrapy\" aria-label=\"1 what is scrapy permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. What is Scrapy?</h1>\n<p>According to the official document, <code class=\"language-text\">Scrapy</code> is an application framework for crawling web sites and extracting structured data which can be used for a wide range of useful applications, like data mining, information processing or historical archival.</p>\n<h1 id=\"2-starting-a-scrapy-project\"><a href=\"#2-starting-a-scrapy-project\" aria-label=\"2 starting a scrapy project permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Starting a <code class=\"language-text\">Scrapy</code> project</h1>\n<p>I intalled <code class=\"language-text\">Scrapy</code> in a virtual environment created with <code class=\"language-text\">Miniconda</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(bedataproj) pip install scrapy</code></pre></div>\n<p>And created a <code class=\"language-text\">Scrapy</code> project</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(bedataproj) scrapy startproject project_name</code></pre></div>\n<p>A <code class=\"language-text\">genspider</code> command helps create a data crawling spider.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(bedataproj) scrapy genspider spider_name website</code></pre></div>\n<p>Below is the spider</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">##spider.py\n\nimport scrapy\n\nclass MusicSpiderSpider(scrapy.Spider):\n    name = &#39;music_spider&#39;\n    start_urls = [&#39;http://www.mnet.com/chart/TOP100/20190623&#39;]\n\n    def parse(self, response):\n        top_selector = &#39;.MMLITitle_Box&#39;\n\n        for music in response.css(top_selector):\n            musician = &#39;.MMLITitle_Info .MMLIInfo_Artist ::text&#39;\n            song = &#39;.MMLITitleSong_Box .MMLI_Song ::text&#39;\n            album = &#39;.MMLITitle_Info .MMLIInfo_Album ::text&#39;\n            yield {\n                &quot;song&quot; : music.css(song).extract_first(),\n                &quot;musician&quot; : music.css(musician).extract_first(),\n                &quot;album&quot; : music.css(album).extract_first(),\n            }</code></pre></div>\n<p>I will explain each component of the spider. <br></p>\n<ol>\n<li><code class=\"language-text\">name</code> is the name of the spider<br></li>\n<li><code class=\"language-text\">start_urls</code> is the website you would like to crawl your data from <br></li>\n<li><code class=\"language-text\">parse</code> function is how you are going to parse the crawled data</li>\n</ol>\n<p>When you crawl data from a webiste using <code class=\"language-text\">Scrapy</code>, the easiest way is using <code class=\"language-text\">class</code> and/or <code class=\"language-text\">id</code> as if you are applying CSS to HTML.</p>\n<p>Appending <code class=\"language-text\">::text</code> to a selector means that I am going to crawl innerText of the class. <br>\nAnd then I called <code class=\"language-text\">extract_first()</code> on the object returned by <code class=\"language-text\">music.css(selector)</code> because I am extracting the first element that matches the selectorâ€”in case there are more than one.</p>\n<p>Then you run <code class=\"language-text\">Scrapy</code> like below</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">scrapy runspider spider_name</code></pre></div>","fields":{"slug":"/posts/DataAnalysis-Scrapy","tagSlugs":["/tag/python/","/tag/scrapy/","/tag/dataanalysis/"]},"frontmatter":{"date":"2019-06-21T19:56:37.121Z","description":"Data Analysis project using Scrapy and Luigi","tags":["python","scrapy","dataanalysis"],"title":"Data Crawling Using Scrapy"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/DataAnalysis-Scrapy"}}}